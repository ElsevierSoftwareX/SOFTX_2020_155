# RCG Makefile; autogenerated do not edit

SHELL = /bin/sh

top_srcdir=@top_srcdir@
srcdir=@srcdir@
VPATH=@srcdir@

prefix      = @prefix@
exec_prefix = @exec_prefix@
bindir      = @bindir@
infodir     = @infodir@
mandir      = @mandir@
infodir     = @infodir@
libdir      = @libdir@

CXX=@CXX@
CC=@CC@
LIBS=@LIBS@
DEBUGFLAGS=-g
PERFORMANCEFLAGS=-DNDEBUG -g -O5
RELEASEFLAGS=-DNDEBUG -DNPROBE -g -O5
#DEBUGFLAGS=-DNDEBUG -O5 -unroll=16
DEVFLAGS=@DEVFLAGS@

%:
	@mkdir -p src/epics/util src/fe target build src/epics/fmseq config src/include
	@ln -fs $(srcdir)/src/epics/util/lib src/epics/util
	@ln -fs $(srcdir)/src/include/drv src/include
	@ln -fs $(srcdir)/src/epics/simLink src/epics
	@ln -fs $(srcdir)/src/epics/util/GNUmakefile src/epics/util
	(cd src/epics/util; make -f Makefile $@)
	/bin/rm -rf build/$@epics-medm
	/bin/rm -rf build/$@epics-config
	/bin/mv -f build/$@epics/medm build/$@epics-medm
	/bin/mv -f build/$@epics/config build/$@epics-config
	/bin/rm -rf target/$@epics build/$@epics;
	env RCG_SRC_DIR=$(srcdir) PERL5LIB=$(srcdir)/src/epics/util make -f config/Makefile.$@epics RCG_SRC_DIR=$(srcdir)
	(cd src/epics/util; $(srcdir)/src/epics/util/nameLengthChk.pl $@)
	/bin/mkdir -p build/$@epics
	/bin/mv -f build/$@epics-medm build/$@epics/medm
	/bin/mv -f build/$@epics-config build/$@epics/config
	(cd src/fe/$@; make clean; make)
	@echo
	@echo The following files were used for this build:
	@cat src/epics/util/sources
	@echo
	@echo Successfully compiled


all: 
	
reclean:
	-/bin/rm -rf build config src target

clean-%:
	@system=$(subst clean-,,$@); \
        /bin/rm -rf target/$${system}epics build/$${system}epics; \
        (cd src/fe/$${system}; make -i clean || true); \


install-%:
	@system=$(subst install-,,$@); $(srcdir)/install $${system} $(srcdir)

uninstall-%:
	@system=$(subst uninstall-,,$@); $(srcdir)/uninstall $${system} $(srcdir)
